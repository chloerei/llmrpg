<%
  position_class = message.creator_type == "Persona" ? "chat-end" : "chat-start"
%>

<div class="chat <%= position_class %>"
  data-controller="message"
  data-message-status-value="<%= message.status %>"
  data-message-completion-url-value="<%= completion_conversation_message_path(message.conversation, message) %>"
  >
  <div class="chat-image">
    <%= render "shared/avatar", avatar: message.creator.avatar, name: message.creator.name %>
  </div>
  <div class="chat-bubble" data-message-target="content">
    <% if message.pending? and message.content.nil? %>
      <span class="loading loading-dots loading-sm"></span>
    <% else %>
      <%= markdown_render message.content %>
    <% end %>
  </div>
</div>
